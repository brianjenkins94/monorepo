{
	"name": "ci",
	"on": {
		"push": {
			"branches": [
				"main"
			]
		}
	},
	"jobs": {
		"build": {
			"runs-on": "ubuntu-latest",
			"steps": [
				{
					"uses": "actions/checkout@v3"
				},
        {
          "uses": "actions/setup-node@v3",
          "with": {
            "node-version": 18
          }
        },
				{
					"run": "npm install"
				},
				{
					"run": "npm run build"
				}
			]
		},
    "lint": {
			"runs-on": "ubuntu-latest",
			"steps": [
				{
					"uses": "actions/checkout@v3"
				},
        {
          "uses": "actions/setup-node@v3",
          "with": {
            "node-version": 18
          }
        },
				{
					"run": "npm install"
				},
				{
					"run": "npm run lint"
				}
			]
		},
		"test": {
			"runs-on": "ubuntu-latest",
			"steps": [
				{
					"uses": "actions/checkout@v3"
				},
        {
          "uses": "actions/setup-node@v3",
          "with": {
            "node-version": 18
          }
        },
				{
					"run": "npm install"
				},
				{
					"run": "npm run test"
				}
			]
		},
		"enumerate": {
			"runs-on": "ubuntu-latest",
      "needs": ["lint", "build", "test"],
			"steps": [
				{
					"uses": "actions/checkout@v3"
				},
				{
					"run": "echo TAG_NAME=[$(find . -mindepth 2 -name \"package.json\" -not -path \"*/.*\" -not -path \"*/node_modules/**\" -exec git diff HEAD^ --quiet \"{}\" \; -exec echo \"{}\" \; | sed -z \"s/^/\\\"/;s/\\n$/\\\"/;s/\\n/\\\", \\\"/g\")] >> $GITHUB_OUTPUT"
				},
				{
					"run": "cat $GITHUB_OUTPUT"
				}
			]
		}
	}
}
